{"version":3,"sources":["js\\index.js"],"names":["app","init","g","bird","document","getElementsByClassName","main","s","birdTimer","pipeTimer","y","minY","maxY","playing","pipeData","scoreEl","start","querySelector","score","_this","onclick","style","display","startGame","window","onkeydown","e","keyCode","innerHTML","forEach","pipe","removeChild","remove","body","className","setInterval","renderBird","updatePipe","Math","max","min","currentPipe","scoring","offsetLeft","hitDetection","upHeight","round","random","downHeight","createElement","rangeMinY","rangeMaxY","appendChild","push","shift","endGame","clearInterval"],"mappings":"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","file":"js.ee15ff2f.map","sourceRoot":"..","sourcesContent":["\r\nvar app = {\r\n  init:function(){\r\n    this.g = 0.2 //向下加速度\r\n    this.bird = document.getElementsByClassName('bird')[0]\r\n    this.main = document.getElementsByClassName('main')[0]\r\n    this.s = 0 //小鸟的速度向下为正\r\n    this.birdTimer = null\r\n    this.pipeTimer = null //两个计时器\r\n    this.y = 100\r\n    this.minY = 0\r\n    this.maxY = 450 - 24 //小鸟的高度，0为天,450-24（小鸟的身高）为地\r\n    this.playing = false //标记是否游戏中\r\n    this.pipeData = [] //管道存放的数组\r\n    this.scoreEl = document.getElementsByClassName('score')[0]\r\n    this.start = document.querySelector('.start')\r\n    this.score = 0\r\n    var _this = this\r\n\r\n    this.start .onclick = function(){\r\n      _this.start.style.display = 'none'\r\n      _this.playing || _this.startGame()\r\n    }\r\n    this.main.onclick=function(){\r\n      _this.s = -4\r\n    }\r\n    // document.ontouchstart = function(){\r\n    //   _this.playing || _this.startGame()\r\n    //   _this.playing = true\r\n    //   _this.s = -4\r\n    // }\r\n    window.onkeydown = function (e) {\r\n        if (e.keyCode == 13) {\r\n            _this.start.style.display = 'none'\r\n            _this.playing || _this.startGame()\r\n        }\r\n        if (e.keyCode == 32) {\r\n            _this.s = -4\r\n        }\r\n    }\r\n  },\r\n  startGame:function(){   /* 开始游戏，开始周期性渲染小鸟位置，生成管道，标记开始,初始化一些值 */\r\n    this.playing = true\r\n    this.y = 100\r\n    this.score = 0\r\n    this.scoreEl.innerHTML = this.score\r\n    this.s = 0\r\n    var _this = this\r\n    this.pipeData.forEach(function (pipe) {\r\n        _this.main.removeChild(pipe)\r\n    })\r\n    this.pipeData = []\r\n    this.main.remove\r\n    document.body.className = ''\r\n    /* 15毫秒渲染一次小鸟 */\r\n    this.birdTimer = setInterval(function () {\r\n        _this.renderBird()\r\n    }, 15)\r\n    /* 1.5秒生成一对管道 */\r\n    this.updatePipe()\r\n    this.pipeTimer = setInterval(function () {\r\n        _this.updatePipe()\r\n    }, 1500)\r\n  },\r\n  renderBird:function(){  /* 渲染小鸟，计分，渲染后检测碰撞 */\r\n    this.s = this.s + this.g\r\n    this.y = this.y + this.s\r\n    this.y = Math.max(this.minY, this.y)\r\n    this.y = Math.min(this.maxY,this.y)\r\n    this.bird.style = `top:${this.y}px`\r\n    let currentPipe = this.pipeData[0] && this.pipeData[0].scoring ? this.pipeData[1] : this.pipeData[0]\r\n    if ((!currentPipe.scoring) && currentPipe.offsetLeft < (150 - 50)) {\r\n        this.score++\r\n        this.scoreEl.innerHTML = this.score\r\n        currentPipe.scoring = true\r\n    }\r\n    this.hitDetection()\r\n  },\r\n  updatePipe:function(){  /*更新管道，创建一对竖直位置随机的管道，并且移除用过的管道 */\r\n    let upHeight = Math.round(Math.random() * 120 + 90) //控制高度在90-210之间\r\n    let downHeight = 300 - upHeight\r\n    let pipe = document.createElement('div')\r\n    pipe.className = 'pipe'\r\n    pipe.rangeMinY = upHeight //允许通过的最小y坐标，向下为正\r\n    pipe.rangeMaxY = upHeight + 150 //允许通过的最大Y坐标\r\n    pipe.innerHTML = `<div class=\"up\" style=\"height:${upHeight}px\"></div>\r\n                    <div class=\"down\" style=\"height:${downHeight}px\"></div>`\r\n    this.main.appendChild(pipe)\r\n    this.pipeData.push(pipe)\r\n    while (this.pipeData[0].offsetLeft == -52) {\r\n        this.main.removeChild(this.pipeData[0])\r\n        this.pipeData.shift()\r\n    }\r\n  },\r\n  hitDetection:function(){  /* 碰撞检测 */\r\n    var _this = this\r\n    if (this.y == this.maxY) {\r\n        _this.endGame()\r\n    }\r\n    this.pipeData.forEach(function (pipe) {\r\n        if (pipe.offsetLeft >= (150 - 50) && pipe.offsetLeft <= (150 + 32)) {\r\n            if (_this.y <= pipe.rangeMinY || _this.y >= (pipe.rangeMaxY - 24)) {\r\n                _this.endGame()\r\n            }\r\n        }\r\n    })\r\n  },\r\n  endGame:function(){  /* 结束游戏，停止周期计时,停止动画 */\r\n    this.start.style.display = 'block'\r\n    this.playing = false\r\n    document.body.className = 'stop'\r\n    clearInterval(this.birdTimer)\r\n    clearInterval(this.pipeTimer)\r\n  }\r\n}\r\n\r\napp.init()\r\n"]}